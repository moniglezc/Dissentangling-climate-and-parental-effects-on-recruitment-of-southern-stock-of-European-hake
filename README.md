# Dissentangling-climate-and-parental-effects-on-recruitment-of-southern-stock-of-European-hake

To investigate the factors influencing the annual variability of recruitment (R) in the southern stock of European hake (female population), Generalized Additive Models (GAMs) were used. These were fitted assuming a Gaussian distribution , initially considering as predictor variables environmental factors ( SST, AMO, NAO) and biological factors (SSB, and female Shannon index and L50), according to the following model:

Rt=s(SSBt)+s(shannon_females_seasonXt)+s(L50_femalest)+s(SSTt)+s(AMOt)+s(NAOt)+εt,

where Rt is the recruitment in year t, s() are smooth functions (splines) estimated by the Generalized Additive Model (GAM), SSTt is sea surface temperature, AMOt is the Atlantic Multidecadal Oscillation, NAOt is the North Atlantic Oscillation, Shannon_females_seasonXt is the Shannon diversity index of the length structure of the stock in season X, L50_females is the mean females length at first maturity, and εt is the random error term. 

Data exploration was carried out following the protocol described in Zuur, Ieno & Elphick (2010) to identify any outliers and any correlation and collinearity between explicative variables. Correlation was checked with the corrplot package (Friendly, 2002) and ggpairs function of the GGally package (Schloerke et al., 2021) of the R software using Spearman`s correlation test method. Collinearity of the predictor variables was tested with the vif function of the package car (Fox and Weisberg 2019). Due to high correlation (r > 0.70) between SST and AMO, these variables were excluded from the model. Similarly, because of high collinearity (VIF > 5) among the seasonal Shannon indices, seasons 2 and 4 were omitted from the model. Covariables in the model were selected with a forward stepwise procedure based on the Akaike information criterion (AIC) and an adjusted R-square. The best (and most parsimonious) model was finally chosen based on the compromise between low AIC values, a high adjusted R-square and significant predictors.

In this case, GAMs were fitted using cubic regression splines as the basis for the explanatory variables, with REML as the method for parameter estimation. The basis dimension was restricted to a k=4 to allow sufficient flexibility while avoiding overfitting problems. When a spline was not required (edf=1), the variable was considered a linear effect. For each final GAM, a diagnosis of the model assumptions was carried  out,  among  which the independence of the residuals was verified using the auto-correlation (ACF) and partial autocorrelation (PACF) functions and the Ljung-Box test (Wood 2006). When Ljung-Box test indicated a potential temporal trend, the auto.arima() function from the forecast package (Hyndman et al., 2019) was used to check for any temporal structure in the model residuals. The best-fitting model was an ARMA (0,0,0) with zero mean, suggesting that the residuals do not exhibit any structured temporal pattern and can be considered white noise. Additionally, results of Jarque-Bera and Shapiro-Wilk tests (normality assumption), a Dickye-Fuller test (stationarity assumption) and a Student t-test (zero mean assumption) were also explored. The GAMs were performed using the function gam of the mgcv package (Wood 2011) of the R software

The final model for recruitment(R) was specified as:

Rt=SSBt+L50_femalest+s(shannon_females_season1t)+s(shannon_females_season3t)+s(NAOt)+εt 
